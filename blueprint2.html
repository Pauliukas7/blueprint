
<div class="container -mb-6" id="page-container">
  <div class="row row-lg">
    <div class="col pb-6">
      <nav class="font-size-md mt-6">
        <ol class="breadcrumbs">
          <li title="Adform">
            <a href="/hc/en-us">Homepage</a>
          </li>
          <li title="Release Notes">Site Tracking Blueprint</li>
        </ol>
      </nav>

      <header class="sm:flex justify-content-between">
        <h1 class="w-full md:mt-2">Site Tracking Blueprint</h1>
      </header>
      <div class="panel panel-default">
        <div class="panel-heading">
          <p>LOL</p>
        </div>
        <div class="panel-body collapse">BODY</div>
      </div>
      <style>

      .types-container {
        width: 50%;
        display: flex;
        justify-content: flex-start;
        border: 1px solid black;
        gap: 5px;
      }

      .website-type {
        height: 15rem;
        width: 15rem;

        border: 1px solid black;
      }
      .pagename-options-container {
        display: flex;
        max-width: 45rem;
      }

      .scripts-and-vars {
    
        display: flex;
        height: 20rem;
    
      }
      .variables- {
  
        overflow: scroll;
        width: 30rem;
      }
      .code-toolbar {
        overflow-x: scroll;
        overflow-y: auto ;

      }
      .input-with-question-popup-container {
        display: flex;
        position: relative;
        height: 21px;
      }

      .input-with-question-popup-container > select {
        height: 2rem;
      }
      .input-with-question-popup-container {
        display: flex;
        position: relative;
        
        height: 21px;
      }
      .tracking-domain-information-text {
        margin-inline-start: 5px;
      }
      .question-mark-element {
        height: 21px;
      }
      .question-mark-symbol {
        margin-inline: 6px;
        font-size: large;
        font-weight: bold;
      }
      .question-mark-element:hover .question-mark-symbol {
        color: #798297;
      }

      .question-mark-element .question-mark-hover-text {
        visibility: hidden;
        width: 100%;
        text-align: center;
        position: absolute;
        margin-left: 10px;
        z-index: 1;
      }
      input::-webkit-outer-spin-button,
      input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }



      .question-mark-element:hover {
        cursor: pointer;
      }
      .question-mark-element:hover span {
        visibility: visible;
      }

      .website-type:hover {
        cursor: pointer;
      }
      .checkbox:hover {
        cursor: pointer;
        cursor: pointer;
      }
      .page-option:hover {
        background-color: #fbfbf8;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div id="types" class="types-container">
      <div class="website-type" id="casino">Casino</div>
      <div class="website-type" id="ecommerce">Ecommerce</div>
      <div class="website-type" id="custom">Custom Website</div>
    </div>

    <div class="pagename-options-container" id="options-container">
      <div class="pagenames" id="pagenames" hidden></div>
      <div id="dcoContainer">
        <input type="checkbox" id="dcoselection" hidden />
        <label for="dcoselection" id="dcoselectionlabel" hidden
          >DCO Product Retargeting Template</label
        >
      </div>
    </div>
    <div id="error-message" hidden></div>
    <div id="scripts" class="codes-container" hidden></div>

    <script>
      window.generateCodesButtonDisabled = true;
      window.dcoTemplateSelected = false;
      window.selectedPageNames = [];
      window.productLevelVars = {};
      window.orderLevelVars = {};
      const HTMLSCRIPTS = "";
      function insertAfter(newNode, existingNode) {
        existingNode.parentNode.insertBefore(newNode, existingNode.nextSibling);
      }
      const websiteTypesContainer = document.getElementById("types");
      const optionsContainer = document.getElementById("options-container");
      const pageNamesContainer = document.getElementById("pagenames");
      const dcoSelectionElement = document.getElementById("dcoselection");
      const dcoSelectionElementLabel =
        document.getElementById("dcoselectionlabel");

      const errorMessageElement = document.getElementById("error-message");
      const scriptsContainer = document.getElementById("scripts");

      function createPagesCheckboxList(pageNamesArray) {
        const generateCodesButton = document.createElement("button");
        generateCodesButton.className ="button button-primary"

        dcoSelectionElement.onchange = () => {
          window.dcoTemplateSelected = dcoSelectionElement.checked
            ? true
            : false;
          const pageNameDivs =
            pageNamesContainer.querySelectorAll(".page-option");

          if (dcoSelectionElement.checked) {
            pageNameDivs.forEach((option) => {
              option.childNodes[0].disabled = true;
            });
          } else {
            pageNameDivs.forEach(
              (option) => (option.childNodes[0].disabled = false)
            );
          }

          if (
            (trackingIdNotEmpty && numOfPagesChecked > 0) ||
            (trackingIdNotEmpty && window.dcoTemplateSelected)
          ) {
            generateCodesButton.disabled = false;
            window.generateCodesButtonDisabled = false;
          } else {
            generateCodesButton.disabled = true;
            window.generateCodesButtonDisabled = true;
          }
        };

        pageNamesContainer.innerHTML = "";
        let IDarray = [];
        window.numOfPagesChecked = 0;
        window.trackingIdNotEmpty = false;
        pageNamesArray.forEach((pageName) => {
          const pageCheckbox = document.createElement("input");
          pageCheckbox.type = "checkbox";
          pageCheckbox.id = pageName.split(" ").join("").toLowerCase(); //e.g. "First time deposit" html element id will be "firsttimedeposit"
          IDarray.push(pageCheckbox.id);
          pageCheckbox.className = "checkbox";
          pageCheckbox.value = pageName;
          pageCheckbox.onchange = () => {
            pageCheckbox.checked ? numOfPagesChecked++ : numOfPagesChecked--;
            if (
              (trackingIdNotEmpty && numOfPagesChecked > 0) ||
              (trackingIdNotEmpty && window.dcoTemplateSelected)
            ) {
              window.generateCodesButtonDisabled = false;
              generateCodesButton.disabled = false;
            } else {
              window.generateCodesButtonDisabled = true;
              generateCodesButton.disabled = true;
            }
          };
          //Create a label for every checkbox
          const pageLabel = document.createElement("label");
          pageLabel.htmlFor = pageCheckbox.id;
          pageLabel.innerText = pageName;
          pageLabel.className = "checkbox";

          //
          const pageContainer = document.createElement("div");
          pageContainer.className = "page-option";
          pageContainer.appendChild(pageCheckbox);
          pageContainer.appendChild(pageLabel);

          pageNamesContainer.appendChild(pageContainer);
          pageNamesContainer.appendChild(document.createElement("br"));
        });
        let custom_id_number = 0;
        if (window.currentPage === "ecommerce") {
          dcoSelectionElement.hidden = false;
          dcoSelectionElementLabel.hidden = false;
        } else {
          dcoSelectionElement.hidden = true;
          dcoSelectionElementLabel.hidden = true;
        }
        custom_id_number++;
        const customCheckbox = document.createElement("input");
        customCheckbox.type = "checkbox";
        customCheckbox.id = "custom" + custom_id_number;
        IDarray.push(customCheckbox.id);
        customCheckbox.className = "checkbox";
        customCheckbox.value = "";
        customCheckbox.onchange = () => {
          if (customCheckbox.checked && customCheckbox.value.length > 0)
            numOfPagesChecked++;
          else if (!customCheckbox.checked && customCheckbox.value.length > 0)
            numOfPagesChecked--;

          if (
            (trackingIdNotEmpty && numOfPagesChecked > 0) ||
            (trackingIdNotEmpty && window.dcoTemplateSelected)
          ) {
            window.generateCodesButtonDisabled = false;
            generateCodesButton.disabled = false;
          } else {
            window.generateCodesButtonDisabled = true;
            generateCodesButton.disabled = true;
          }
        };

        const customPageNameInputField = document.createElement("input");
        customPageNameInputField.placeholder = "Insert your page name here";
        const pageContainerCustom = document.createElement("div");
        pageContainerCustom.className = "page-option";
        pageContainerCustom.id = "page-option-custom" + custom_id_number;
        pageContainerCustom.appendChild(customCheckbox);
        pageContainerCustom.appendChild(customPageNameInputField);
        pageNamesContainer.appendChild(pageContainerCustom);
        pageNamesContainer.appendChild(document.createElement("br"));
        customPageNameInputField.onchange = () => {
          const currentValue = customPageNameInputField.value;
          customCheckbox.value = currentValue;
          if (customCheckbox.checked && customCheckbox.value.length > 0)
            numOfPagesChecked++;
          else if (customCheckbox.checked && customCheckbox.value.length === 0)
            numOfPagesChecked--;

          if (
            (trackingIdNotEmpty && numOfPagesChecked > 0) ||
            (trackingIdNotEmpty && window.dcoTemplateSelected)
          ) {
            window.generateCodesButtonDisabled = false;
            generateCodesButton.disabled = false;
          } else {
            window.generateCodesButtonDisabled = true;
            generateCodesButton.disabled = true;
          }
        };

        const addCustomPageNameButton = document.createElement("button");
        addCustomPageNameButton.innerText = "Add another page name";
        addCustomPageNameButton.id = "addCustomPage";
        addCustomPageNameButton.className = "button button-secondary";

        addCustomPageNameButton.addEventListener("click", () => {
          custom_id_number++;
          const newCustomPageContainer = pageContainerCustom.cloneNode(true);
          const clonedCheckbox = newCustomPageContainer.childNodes[0];
          clonedCheckbox.id = "custom" + custom_id_number;
          IDarray.push(clonedCheckbox.id);
          const clonedInputField = newCustomPageContainer.childNodes[1];
          clonedCheckbox.value = "";
          clonedCheckbox.checked = false;
          clonedInputField.value = "";
          clonedCheckbox.onchange = () => {
            if (clonedCheckbox.checked && clonedCheckbox.value.length > 0)
              numOfPagesChecked++;
            else if (!clonedCheckbox.checked && clonedCheckbox.value.length > 0)
              numOfPagesChecked--;

            if (
              (trackingIdNotEmpty && numOfPagesChecked > 0) ||
              (trackingIdNotEmpty && window.dcoTemplateSelected)
            ) {
              window.generateCodesButtonDisabled = false;
              generateCodesButton.disabled = false;
            } else {
              window.generateCodesButtonDisabled = true;
              generateCodesButton.disabled = true;
            }
          };

          clonedInputField.onchange = () => {
            const currentValue = clonedInputField.value;
            clonedCheckbox.value = currentValue;
            if (clonedCheckbox.checked && clonedCheckbox.value.length > 0)
              numOfPagesChecked++;
            else if (
              clonedCheckbox.checked &&
              clonedCheckbox.value.length === 0
            )
              numOfPagesChecked--;

            if (
              (trackingIdNotEmpty && numOfPagesChecked > 0) ||
              (trackingIdNotEmpty && window.dcoTemplateSelected)
            ) {
              window.generateCodesButtonDisabled = false;
              generateCodesButton.disabled = false;
            } else {
              window.generateCodesButtonDisabled = true;
              generateCodesButton.disabled = true;
            }
          };
          newCustomPageContainer.id = "page-option-custom" + custom_id_number;
          const thisButton = Array.from(pageNamesContainer.childNodes).find(
            (element) => element.id === "addCustomPage"
          );
          pageNamesContainer.insertBefore(newCustomPageContainer, thisButton);
          pageNamesContainer.insertBefore(
            document.createElement("br"),
            thisButton
          );
        });

        pageNamesContainer.appendChild(addCustomPageNameButton);
        pageNamesContainer.appendChild(document.createElement("br"));
        pageNamesContainer.appendChild(document.createElement("br"));

        generateCodesButton.disabled = true;
        generateCodesButton.innerText = "Generate Tracking scripts";
        const p = document.createElement("p")
        p.innerText = "Enter your tracking setup ID:"
         pageNamesContainer.appendChild(p);
         const trackingSetupIdQuestionMark = document.createElement("span");
        trackingSetupIdQuestionMark.className = "question-mark-element";

        trackingSetupIdQuestionMark.innerHTML =
          `<span class='question-mark-symbol'>?</span> <span class="question-mark-hover-text">Your tracking setup ID can be found by navigating to your Flow account -> <b>Buy-Side Platform</b> -> <b>Site Tracking</b> -> <b>ID</b> field on the right side </span>`;
          pageNamesContainer.appendChild(trackingSetupIdQuestionMark)
        const trackingSetupIdInputContainer = document.createElement("div");
        trackingSetupIdInputContainer.className =
          "input-with-question-popup-container";

        const trackingSetupIdField = document.createElement("input");
        trackingSetupIdField.type = "number";
        trackingSetupIdField.placeholder = "Enter your tracking setup ID";
        trackingSetupIdField.oninput = () => {
          trackingIdFieldNotEmpty = trackingSetupIdField.value.length > 0;
          trackingIdFieldNotEmpty
            ? (window.trackingIdNotEmpty = true)
            : (window.trackingIdNotEmpty = false);

          if (
            (trackingIdNotEmpty && numOfPagesChecked > 0) ||
            (trackingIdNotEmpty && window.dcoTemplateSelected)
          ) {
            window.generateCodesButtonDisabled = false;
            generateCodesButton.disabled = false;
          } else {
            window.generateCodesButtonDisabled = true;
            generateCodesButton.disabled = true;
          }
        };
        

        trackingSetupIdInputContainer.appendChild(trackingSetupIdField);
        

        const trackingDomainContainer = document.createElement("div");
        trackingDomainContainer.className =
          "input-with-question-popup-container";

        const trackingDomainInformationText = document.createElement("div");
        trackingDomainInformationText.innerHTML =
          "<a href='https://www.adformhelp.com/hc/en-us/articles/9740579553169' target='_blank'>Click here</a> for more information on tracking domains";
        trackingDomainInformationText.className = "tracking-domain-information-text"
        const trackingDomainDropdown = document.createElement("select");
        trackingDomainDropdown.id = "trackingdomains";

        const domainAmericas = document.createElement("option");
        domainAmericas.value = "a2.adform.net";
        domainAmericas.innerText = "Americas (a2.adform.net)";

        const domainAPAC = document.createElement("option");
        domainAPAC.value = "asia.adform.net";
        domainAPAC.innerText = "APAC (asia.adform.net)";

        const domainCHINA = document.createElement("option");
        domainCHINA.value = "adfnet.cn";
        domainCHINA.innerText = "China (adfnet.cn)";

        const domainEMEA = document.createElement("option");
        domainEMEA.value = "track.adform.net";
        domainEMEA.innerText = "EMEA (track.adform.net)";

        const domainEMEAServer = document.createElement("option");
        domainEMEAServer.value = "server.adform.net";
        domainEMEAServer.innerText = "EMEA (server.adform.net)";

        const domainGLOBAL = document.createElement("option");
        domainGLOBAL.value = "a1.adform.net";
        domainGLOBAL.innerText = "GLOBAL (a1.adform.net)";

        trackingDomainDropdown.appendChild(domainEMEA);
        trackingDomainDropdown.appendChild(domainAmericas);
        trackingDomainDropdown.appendChild(domainAPAC);
        trackingDomainDropdown.appendChild(domainCHINA);
        trackingDomainDropdown.appendChild(domainEMEAServer);
        trackingDomainDropdown.appendChild(domainGLOBAL);
        window.trackingDomain = trackingDomainDropdown.value;

        trackingDomainDropdown.onchange = () =>
          (window.trackingDomain = trackingDomainDropdown.value);
        trackingDomainContainer.appendChild(trackingDomainDropdown);
        trackingDomainContainer.appendChild(trackingDomainInformationText);

        pageNamesContainer.appendChild(trackingSetupIdInputContainer);
        pageNamesContainer.appendChild(document.createElement("br"));
        pageNamesContainer.appendChild(document.createElement("br"));
        pageNamesContainer.appendChild(trackingDomainContainer);
        pageNamesContainer.appendChild(document.createElement("br"));
        pageNamesContainer.appendChild(document.createElement("br"));
        pageNamesContainer.appendChild(generateCodesButton);

        function GenerateScripts(
          pageNamesArray,
          trackingSetupID,
          trackingDomain
        ) {
          let scriptNodeList = [];
          if (window.dcoTemplateSelected) {
            pageNamesArray = [
              "Product Page",
              "Basket Page",
              "Purchase Completed"
            ];
          }

          pageNamesArray.forEach((pageName) => {
            const pre = document.createElement("pre");
            pre.className = "language-js hljs javascript code-snippet";
            const code = document.createElement("code");
            const pageClassName = pageName.replaceAll(" ", "");
            code.className = pageClassName;
      			code.classList.add("language-js")
            code.innerHTML = `&#x3C;!-- Adform Tracking Code BEGIN --&#x3E;
&#x3C;script type=&#x22;text/javascript&#x22;&#x3E;
    window._adftrack = Array.isArray(window._adftrack) ? window._adftrack : (window._adftrack ? [window._adftrack] : [])
    window._adftrack.push({
        HttpHost: '${trackingDomain}',
        pm: ${trackingSetupID},
        divider: encodeURIComponent('|'),
        pagename: encodeURIComponent('${pageName}')
        });
    (function () { var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = 'https://s2.adform.net/banners/scripts/st/trackpoint-async.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); })();
&#x3C;/script&#x3E;
&#x3C;noscript&#x3E;
    &#x3C;p style="margin:0;padding:0;border:0;">
        &#x3C;img src="https://${trackingDomain}/Serving/TrackPoint/?pm=${trackingSetupID}&ADFPageName=${encodeURIComponent(
              pageName
            )}&ADFdivider=|" width="1" height="1" alt="" />
    &#x3C;/p&#x3E;
&#x3C;/noscript&#x3E;
&#x3C;!-- Adform Tracking Code END --&#x3E;`;

            const scriptsDiv = document.createElement("div");
            scriptsDiv.className = "scripts-and-vars";
            const varsDiv = document.createElement("div");
            varsDiv.className = "variables- " + pageClassName;
            varsDiv.innerHTML = `
        Variables
        <br />
        <br />
        <input type="checkbox" value="sales" id="sales" data-level="order" />
        <label for="sales">Sales (number)</label>
        <br />
        <input
          type="checkbox"
          value="orderid"
          id="orderid"
          data-level="order"
        />
        <label for="sales">Order ID</label>
        <br />
        <br />
        <div class="product-variables">Product variables:</div>
        <br />
        <input
          type="checkbox"
          value="categoryname"
          id="categoryname"
          data-level="product"
        />
        <label for="categoryname">Category Name (text)</label>
        <br />
        <input
          type="checkbox"
          value="categoryid"
          id="categoryid"
          data-level="product"
        />
        <label for="categoryid">Category ID (text)</label>
        <br />
        <input
          type="checkbox"
          value="productname"
          id="productname"
          data-level="product"
        />
        <label for="productname">Product Name (text)</label>
        <br />
        <input
          type="checkbox"
          value="productid"
          id="productid"
          data-level="product"
        />
        <label for="salproductides">Product ID(text)</label>
        <br />
        <input
          type="checkbox"
          value="weight"
          id="weight"
          data-level="product"
        />
        <label for="weight">Weight (number)</label>
        <br />
        <input type="checkbox" value="step" id="step" data-level="product" />
        <label for="step">Step (number)</label>
        <br />
        <input
          type="checkbox"
          value="productcount"
          id="productcount"
          data-level="product"
        />
        <label for="productcount">Product Count (number)</label>
        <br />
        <input
          type="checkbox"
          value="productsales"
          id="productsales"
          data-level="product"
        />
        <label for="productsales">Product Sales (number)</label>
        <br />
        <input
          type="checkbox"
          value="productcount"
          id="productcount"
          data-level="product"
        />
        <label for="productcount">Product Count (number)</label>
        <br />
        <br />

        <input
          type="checkbox"
          value="sv1"
          id="sv1"
          data-level="order"
        />
        <label for="sv1">sv1 (text)</label>
        <select id="data-level-sv1">
          <option>Order</option>
          <option>Product</option>
          </select>
          <br />

          <input
          type="checkbox"
          value="sv2"
          id="sv2"
          data-level="order"
        />
        <label for="sv2">sv2 (text)</label>
        <select id="data-level-sv2">
          <option>Order</option>
          <option>Product</option>
          </select>
          <br />

          <input
          type="checkbox"
          value="sv3"
          id="sv3"
          data-level="order"
        />
        <label for="sv3">sv3 (text)</label>
        <select id="data-level-sv3">
          <option>Order</option>
          <option>Product</option>
          </select>
          <br />

          <input
          type="checkbox"
          value="sv4"
          id="sv4"
          data-level="order"
        />
        <label for="sv4">sv4 (text)</label>
        <select id="data-level-sv4">
          <option>Order</option>
          <option>Product</option>
          </select>
          <br />

          <input
          type="checkbox"
          value="sv5"
          id="sv5"
          data-level="order"
        />
        <label for="sv5">sv5 (text)</label>
        <select id="data-level-sv5">
          <option>Order</option>
          <option>Product</option>
          </select>
          <br />

          <input
          type="checkbox"
          value="sv6"
          id="sv6"
          data-level="order"
        />
        <label for="sv6">sv6 (text)</label>
        <select id="data-level-sv6">
          <option>Order</option>
          <option>Product</option>
          </select>
          <br />

          <input
          type="checkbox"
          value="sv7"
          id="sv7"
          data-level="order"
        />
        <label for="sv7">sv7 (text)</label>
        <select id="data-level-sv7">
          <option>Order</option>
          <option>Product</option>
          </select>
          <br />

          <input
          type="checkbox"
          value="sv8"
          id="sv8"
          data-level="order"
        />
        <label for="sv8">sv8 (text)</label>
        <select id="data-level-sv8">
          <option>Order</option>
          <option>Product</option>
          </select>
          <br />
        `;
            let variablesContainerElements;
            function renderDOM() {
              if (orderVars.length > 0 || productVars.length > 0) {
                if (orderVars.length > 0 && productVars.length === 0) {
                  let variablesString = "";
                  for (var key of orderVars) {
                    const index = orderVars.indexOf(key);
                    if (index < orderVars.length - 1) {
                      variablesString =
                        variablesString +
                        `${key}: '&#x3C;insert ${key} value here&#x3E;',` +
                        "\n" +
                        "          ";
                    } else {
                      variablesString =
                        variablesString +
                        `${key}: '&#x3C;insert ${key} value here&#x3E;'`;
                    }
                  }
                  document.querySelector(
                    `.${pageClassName}`
                  ).innerHTML = `&#x3C;!-- Adform Tracking Code BEGIN --&#x3E;
&#x3C;script type=&#x22;text/javascript&#x22;&#x3E;
    window._adftrack = Array.isArray(window._adftrack) ? window._adftrack : (window._adftrack ? [window._adftrack] : [])
    window._adftrack.push({
        HttpHost: '${trackingDomain}',
        pm: ${trackingSetupID},
        divider: encodeURIComponent('|'),
        pagename: encodeURIComponent('${pageName}'),
        order: {
          ${variablesString}
        }
        });
    (function () { var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = 'https://s2.adform.net/banners/scripts/st/trackpoint-async.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); })();
&#x3C;/script&#x3E;
&#x3C;noscript&#x3E;
    &#x3C;p style="margin:0;padding:0;border:0;">
        &#x3C;img src="https://${trackingDomain}/Serving/TrackPoint/?pm=${trackingSetupID}&ADFPageName=${encodeURIComponent(
                    pageName
                  )}&ADFdivider=|" width="1" height="1" alt="" />
    &#x3C;/p&#x3E;
&#x3C;/noscript&#x3E;
&#x3C;!-- Adform Tracking Code END --&#x3E;`;
                }
                Prism.highlightAll()
              }

              if (orderVars.length === 0 && productVars.length > 0) {
                let variablesString = "";
                productVars.sort();
                for (var key of productVars) {
                  const index = productVars.indexOf(key);
                  if (index < productVars.length - 1) {
                    variablesString =
                      variablesString +
                      `${key}: '&#x3C;insert ${key} value here&#x3E;',` +
                      "\n" +
                      "              ";
                  } else {
                    variablesString =
                      variablesString +
                      `${key}: '&#x3C;insert ${key} value here&#x3E;'`;
                  }
                }
                document.querySelector(
                  `.${pageClassName}`
                ).innerHTML = `&#x3C;!-- Adform Tracking Code BEGIN --&#x3E;
&#x3C;script type=&#x22;text/javascript&#x22;&#x3E;
    window._adftrack = Array.isArray(window._adftrack) ? window._adftrack : (window._adftrack ? [window._adftrack] : [])
    window._adftrack.push({
        HttpHost: '${trackingDomain}',
        pm: ${trackingSetupID},
        divider: encodeURIComponent('|'),
        pagename: encodeURIComponent('${pageName}'),
        order: {
          itms: [
            {
              ${variablesString}
            }
          ]     
        }
        });
    (function () { var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = 'https://s2.adform.net/banners/scripts/st/trackpoint-async.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); })();
&#x3C;/script&#x3E;
&#x3C;noscript&#x3E;
    &#x3C;p style="margin:0;padding:0;border:0;">
        &#x3C;img src="https://${trackingDomain}/Serving/TrackPoint/?pm=${trackingSetupID}&ADFPageName=${encodeURIComponent(
                  pageName
                )}&ADFdivider=|" width="1" height="1" alt="" />
    &#x3C;/p&#x3E;
&#x3C;/noscript&#x3E;
&#x3C;!-- Adform Tracking Code END --&#x3E;`;
Prism.highlightAll()
              }

              if (orderVars.length > 0 && productVars.length > 0) {
                let orderVariablesString = "";
                for (var key of orderVars) {
                  const index = orderVars.indexOf(key);
                  if (index < orderVars.length - 1) {
                    orderVariablesString =
                      orderVariablesString +
                      `${key}: '&#x3C;insert ${key} value here&#x3E;',` +
                      "\n" +
                      "          ";
                  } else {
                    orderVariablesString =
                      orderVariablesString +
                      `${key}: '&#x3C;insert ${key} value here&#x3E;',`;
                  }
                }

                let productVariablesString = "";
                for (var key of productVars) {
                  const index = productVars.indexOf(key);
                  if (index < productVars.length - 1) {
                    productVariablesString =
                      productVariablesString +
                      `${key}: '&#x3C;insert ${key} value here&#x3E;',` +
                      "\n" +
                      "              ";
                  } else {
                    productVariablesString =
                      productVariablesString +
                      `${key}: '&#x3C;insert ${key} value here&#x3E;'`;
                  }
                }
                document.querySelector(
                  `.${pageClassName}`
                ).innerHTML = `&#x3C;!-- Adform Tracking Code BEGIN --&#x3E;
&#x3C;script type=&#x22;text/javascript&#x22;&#x3E;
    window._adftrack = Array.isArray(window._adftrack) ? window._adftrack : (window._adftrack ? [window._adftrack] : [])
    window._adftrack.push({
        HttpHost: '${trackingDomain}',
        pm: ${trackingSetupID},
        divider: encodeURIComponent('|'),
        pagename: encodeURIComponent('${pageName}'),
        order: {
          ${orderVariablesString}
          itms: [
            {
              ${productVariablesString}
            }
          ]     
        }
        });
    (function () { var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = 'https://s2.adform.net/banners/scripts/st/trackpoint-async.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); })();
&#x3C;/script&#x3E;
&#x3C;noscript&#x3E;
    &#x3C;p style="margin:0;padding:0;border:0;">
        &#x3C;img src="https://${trackingDomain}/Serving/TrackPoint/?pm=${trackingSetupID}&ADFPageName=${encodeURIComponent(
                  pageName
                )}&ADFdivider=|" width="1" height="1" alt="" />
    &#x3C;/p&#x3E;
&#x3C;/noscript&#x3E;
&#x3C;!-- Adform Tracking Code END --&#x3E;`;
Prism.highlightAll()
              }
              if (orderVars.length === 0 && productVars.length === 0) {
                document.querySelector(
                  `.${pageClassName}`
                ).innerHTML = `&#x3C;!-- Adform Tracking Code BEGIN --&#x3E;
&#x3C;script type=&#x22;text/javascript&#x22;&#x3E;
    window._adftrack = Array.isArray(window._adftrack) ? window._adftrack : (window._adftrack ? [window._adftrack] : [])
    window._adftrack.push({
        HttpHost: '${trackingDomain}',
        pm: ${trackingSetupID},
        divider: encodeURIComponent('|'),
        pagename: encodeURIComponent('${pageName}')
        });
    (function () { var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = 'https://s2.adform.net/banners/scripts/st/trackpoint-async.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); })();
&#x3C;/script&#x3E;
&#x3C;noscript&#x3E;
    &#x3C;p style="margin:0;padding:0;border:0;">
        &#x3C;img src="https://${trackingDomain}/Serving/TrackPoint/?pm=${trackingSetupID}&ADFPageName=${encodeURIComponent(
                  pageName
                )}&ADFdivider=|" width="1" height="1" alt="" />
    &#x3C;/p&#x3E;
&#x3C;/noscript&#x3E;
&#x3C;!-- Adform Tracking Code END --&#x3E;`;
Prism.highlightAll()
              }
            }
            window.orderLevelVars[`${pageClassName}`] = [];
            window.productLevelVars[`${pageClassName}`] = [];

            const orderVars = window.orderLevelVars[`${pageClassName}`];
            const productVars = window.productLevelVars[`${pageClassName}`];
            setTimeout(() => {
              variablesContainerElements = varsDiv.childNodes;

              levelVarsSelectElements = varsDiv.querySelectorAll("select");

              levelVarsSelectElements.forEach((selection) => {
                const variableElementId = selection.id.split("data-level-")[1];
                const variableCheckbox =
                  document.getElementById(variableElementId);
                selection.addEventListener("change", () => {
                  const dataSetAfterChange = selection.value.toLowerCase();

                  variableCheckbox.dataset.level = dataSetAfterChange;

                  if (variableCheckbox.checked) {
                    if (dataSetAfterChange === "product") {
                      const elementIndex = orderVars.indexOf(
                        variableCheckbox.value
                      );
                      orderVars.splice(elementIndex, 1);
                      productVars.push(variableCheckbox.value);
                    } else {
                      const elementIndex = productVars.indexOf(
                        variableCheckbox.value
                      );
                      productVars.splice(elementIndex, 1);
                      orderVars.push(variableCheckbox.value);
                    }
                  }
                  renderDOM();

                });
              });

              variablesContainerElements.forEach((element) => {
                if (element.nodeName === "INPUT") {
                  if (window.dcoTemplateSelected) {
                    if (
                      element.value === "productid" ||
                      element.value === "step"
                    ) {
                      productVars.push(element.value);
                      element.checked = true;
                    }
                  }
                  renderDOM();
                  element.onchange = () => {
                    if (element.checked) {
                      if (element.dataset.level === "order") {
                        orderVars.push(element.value);
                      } else {
                        productVars.push(element.value);
                      }
                    } else {
                      if (element.dataset.level === "order") {
                        const elementIndex = orderVars.indexOf(element.value);
                        orderVars.splice(elementIndex, 1);
                      } else {
                        const elementIndex = productVars.indexOf(element.value);
                        productVars.splice(elementIndex, 1);
                      }
                    }

                    renderDOM();
                  };
                }
              });
            }, 0);

            pre.appendChild(code);
            scriptsDiv.appendChild(pre);
            scriptsDiv.appendChild(varsDiv);
            scriptNodeList.push(scriptsDiv);
          });
          scriptsContainer.innerHTML = "";
          scriptNodeList.forEach((node) => scriptsContainer.appendChild(node));
          scriptsContainer.hidden = false;
        }

        generateCodesButton.addEventListener("click", () => {
          window.selectedPageNames = [];
          IDarray.forEach((ID) => {
            const pageName = document.getElementById(ID);
            if (pageName.checked && pageName.value.length > 0)
              window.selectedPageNames.push(pageName.value);
          });
          GenerateScripts(
            window.selectedPageNames,
            trackingSetupIdField.value,
            window.trackingDomain
          );
      
        });
      }

      const casinoType = document.getElementById("casino");
      const ecommerceType = document.getElementById("ecommerce");
      const customType = document.getElementById("custom");
      const casinoOptions = [
        "Homepage",
        "Registration",
        "First Time Deposit",
        "Deposit",
        "Game page"
      ];
      const ecommerceOptions = [
        "Homepage",
        "Product Page",
        "Basket Page",
        "Check-out page",
        "Purchase Completed"
      ];
      const customOptions = ["Homepage"];
      casinoType.addEventListener("click", () => {
        if (window.currentPage !== "casino") {
          window.currentPage = "casino";
          createPagesCheckboxList(casinoOptions);
          pageNamesContainer.hidden = false;
          scriptsContainer.hidden = true;
          dcoSelectionElement.checked = false;
          window.dcoTemplateSelected = false;
        } else {
          pageNamesContainer.hidden = !pageNamesContainer.hidden;
        }
        if (pageNamesContainer.hidden) {
          scriptsContainer.hidden = true;
          errorMessageElement.hidden = true;
        }
      });
      ecommerceType.addEventListener("click", () => {
        if (window.currentPage !== "ecommerce") {
          window.currentPage = "ecommerce";
          createPagesCheckboxList(ecommerceOptions);
          pageNamesContainer.hidden = false;
          dcoSelectionElement.hidden = false;
          dcoSelectionElementLabel.hidden = false;
          scriptsContainer.hidden = true;
        } else {
          pageNamesContainer.hidden = !pageNamesContainer.hidden;
          dcoSelectionElement.hidden = !dcoSelectionElement;
          dcoSelectionElementLabel.hidden = !dcoSelectionElementLabel;
        }

        if (pageNamesContainer.hidden) {
          dcoSelectionElement.hidden = true;
          dcoSelectionElementLabel.hidden = true;
          scriptsContainer.hidden = true;
          errorMessageElement.hidden = true;
        }
      });

      customType.addEventListener("click", () => {
        if (window.currentPage !== "custom") {
          window.currentPage = "custom";
          createPagesCheckboxList(customOptions);
          pageNamesContainer.hidden = false;
          scriptsContainer.hidden = true;
          dcoSelectionElement.checked = false;
          window.dcoTemplateSelected = false;
        } else {
          pageNamesContainer.hidden = !pageNamesContainer.hidden;
        }
        if (pageNamesContainer.hidden) {
          scriptsContainer.hidden = true;
          errorMessageElement.hidden = true;
        }
      });
    </script>
