<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      .types-container {
        display: flex;
        border: 1px solid black;
      }
      .pagename-options-container {
        border: 1px solid black;
        display: flex;
      }
      .scripts-and-vars {
        border: 1px solid black;
        display: flex;
        overflow: scroll;
      }
      .variables {
        width: 3rem;
        border: 1px solid black;
      }

      .website-type {
        height: 6rem;
        width: 6rem;
        border: 1px solid black;
      }
      .website-type:hover {
        cursor: pointer;
      }
      .checkbox:hover {
        cursor: pointer;
        cursor: pointer;
      }
      .page-option:hover {
        border: 1px solid black;
        background-color: aquamarine;
      }
    </style>
  </head>
  <body>
    <div id="types" class="types-container">
      <div class="website-type" id="casino">Casino</div>
      <div class="website-type" id="mobile">Mobile</div>
      <div class="website-type" id="ecommerce">Ecommerce</div>
      <div class="website-type" id="Newsletter">Newsletter</div>
    </div>

    <div class="pagename-options-container" id="options-container">
      <div class="pagenames" id="pagenames" hidden></div>
    </div>
    <div id="error-message" hidden></div>
    <div id="scripts" class="codes-container" hidden></div>

    <script>
      const HTMLSCRIPTS = "";
      function insertAfter(newNode, existingNode) {
        existingNode.parentNode.insertBefore(newNode, existingNode.nextSibling);
      }
      const websiteTypesContainer = document.getElementById("types");
      const optionsContainer = document.getElementById("options-container");
      const pageNamesContainer = document.getElementById("pagenames");

      const errorMessageElement = document.getElementById("error-message");
      const scriptsContainer = document.getElementById("scripts");

      function createPagesCheckboxList(pageNamesArray) {
        let IDarray = [];
        window.numOfPagesChecked = 0;
        window.trackingIdNotEmpty = false;
        pageNamesArray.forEach((pageName) => {
          const pageCheckbox = document.createElement("input");
          pageCheckbox.type = "checkbox";
          pageCheckbox.id = pageName.split(" ").join("").toLowerCase(); //e.g. "First time deposit" html element id will be "firsttimedeposit"
          IDarray.push(pageCheckbox.id);
          pageCheckbox.className = "checkbox";
          pageCheckbox.value = pageName;
          pageCheckbox.onchange = () => {
            pageCheckbox.checked ? numOfPagesChecked++ : numOfPagesChecked--;
            if (trackingIdNotEmpty && numOfPagesChecked > 0)
              generateCodesButton.disabled = false;
            else generateCodesButton.disabled = true;
          };
          //Create a label for every checkbox
          const pageLabel = document.createElement("label");
          pageLabel.htmlFor = pageCheckbox.id;
          pageLabel.innerText = pageName;
          pageLabel.className = "checkbox";

          //
          const pageContainer = document.createElement("div");
          pageContainer.className = "page-option";
          pageContainer.appendChild(pageCheckbox);
          pageContainer.appendChild(pageLabel);

          pageNamesContainer.appendChild(pageContainer);
          pageNamesContainer.appendChild(document.createElement("br"));
        });
        let custom_id_number = 0;

        custom_id_number++;
        const customCheckbox = document.createElement("input");
        customCheckbox.type = "checkbox";
        customCheckbox.id = "custom" + custom_id_number;
        IDarray.push(customCheckbox.id);
        customCheckbox.className = "checkbox";
        customCheckbox.value = "";
        customCheckbox.onchange = () => {
          if (customCheckbox.checked && customCheckbox.value.length > 0)
            numOfPagesChecked++;
          else if (!customCheckbox.checked && customCheckbox.value.length > 0)
            numOfPagesChecked--;

          if (trackingIdNotEmpty && numOfPagesChecked > 0)
            generateCodesButton.disabled = false;
          else generateCodesButton.disabled = true;
        };

        const customPageNameInputField = document.createElement("input");
        customPageNameInputField.placeholder = "Insert your page name here";
        const pageContainerCustom = document.createElement("div");
        pageContainerCustom.className = "page-option";
        pageContainerCustom.id = "page-option-custom" + custom_id_number;
        pageContainerCustom.appendChild(customCheckbox);
        pageContainerCustom.appendChild(customPageNameInputField);
        pageNamesContainer.appendChild(pageContainerCustom);
        pageNamesContainer.appendChild(document.createElement("br"));
        customPageNameInputField.onchange = () => {
          const currentValue = customPageNameInputField.value;
          customCheckbox.value = currentValue;
          if (customCheckbox.checked && customCheckbox.value.length > 0)
            numOfPagesChecked++;
          else if (customCheckbox.checked && customCheckbox.value.length === 0)
            numOfPagesChecked--;

          if (trackingIdNotEmpty && numOfPagesChecked > 0)
            generateCodesButton.disabled = false;
          else generateCodesButton.disabled = true;
        };

        const addCustomPageNameButton = document.createElement("button");
        addCustomPageNameButton.innerText = "Add another page name";
        addCustomPageNameButton.id = "addCustomPage";

        addCustomPageNameButton.addEventListener("click", () => {
          custom_id_number++;
          const newCustomPageContainer = pageContainerCustom.cloneNode(true);
          const clonedCheckbox = newCustomPageContainer.childNodes[0];
          clonedCheckbox.id = "custom" + custom_id_number;
          IDarray.push(clonedCheckbox.id);
          const clonedInputField = newCustomPageContainer.childNodes[1];
          clonedCheckbox.value = "";
          clonedCheckbox.checked = false;
          clonedInputField.value = "";
          clonedCheckbox.onchange = () => {
            if (clonedCheckbox.checked && clonedCheckbox.value.length > 0)
              numOfPagesChecked++;
            else if (!clonedCheckbox.checked && clonedCheckbox.value.length > 0)
              numOfPagesChecked--;

            if (trackingIdNotEmpty && numOfPagesChecked > 0)
              generateCodesButton.disabled = false;
            else generateCodesButton.disabled = true;
          };

          clonedInputField.onchange = () => {
            const currentValue = clonedInputField.value;
            clonedCheckbox.value = currentValue;
            if (clonedCheckbox.checked && clonedCheckbox.value.length > 0)
              numOfPagesChecked++;
            else if (
              clonedCheckbox.checked &&
              clonedCheckbox.value.length === 0
            )
              numOfPagesChecked--;

            if (trackingIdNotEmpty && numOfPagesChecked > 0)
              generateCodesButton.disabled = false;
            else generateCodesButton.disabled = true;
          };
          newCustomPageContainer.id = "page-option-custom" + custom_id_number;
          const thisButton = Array.from(pageNamesContainer.childNodes).find(
            (element) => element.id === "addCustomPage"
          );
          pageNamesContainer.insertBefore(newCustomPageContainer, thisButton);
          pageNamesContainer.insertBefore(
            document.createElement("br"),
            thisButton
          );
        });

        pageNamesContainer.appendChild(addCustomPageNameButton);
        pageNamesContainer.appendChild(document.createElement("br"));
        pageNamesContainer.appendChild(document.createElement("br"));

        const generateCodesButton = document.createElement("button");
        generateCodesButton.disabled = true;
        generateCodesButton.innerText = "Generate Tracking scripts";

        const trackingSetupIdField = document.createElement("input");
        trackingSetupIdField.type = "number";
        trackingSetupIdField.placeholder = "Enter your tracking setup ID";
        trackingSetupIdField.onchange = () => {
          trackingIdFieldNotEmpty = trackingSetupIdField.value.length > 0;
          trackingIdFieldNotEmpty
            ? (window.trackingIdNotEmpty = true)
            : (window.trackingIdNotEmpty = false);

          if (trackingIdNotEmpty && numOfPagesChecked > 0)
            generateCodesButton.disabled = false;
          else generateCodesButton.disabled = true;
        };

        pageNamesContainer.appendChild(trackingSetupIdField);
        pageNamesContainer.appendChild(document.createElement("br"));
        pageNamesContainer.appendChild(document.createElement("br"));

        pageNamesContainer.appendChild(generateCodesButton);

        function GenerateScripts(pageNamesArray, trackingSetupID) {
          if (pageNamesArray.length === 0 || trackingSetupID.length === 0) {
            errorMessageElement.innerText =
              "Please fill out the required fields";
            errorMessageElement.hidden = false;
            scriptsContainer.hidden = true;
          } else {
            errorMessageElement.hidden = true;
            let scriptNodeList = [];
            pageNamesArray.forEach((pageName) => {
              const scriptsDiv = document.createElement("div");
              scriptsDiv.className = "scripts-and-vars";
              const varsDiv = document.createElement("div");
              varsDiv.className = "variables";
              const pre = document.createElement("pre");
              pre.className = "programlisting js";
              pre.setAttribute("data-language", "js");
              const code = document.createElement("code");
              code.innerHTML = `&#x3C;!-- Adform Tracking Code BEGIN --&#x3E;
&#x3C;script type=&#x22;text/javascript&#x22;&#x3E;
    window._adftrack = Array.isArray(window._adftrack) ? window._adftrack : (window._adftrack ? [window._adftrack] : [])
    window._adftrack.push({
        HttpHost: 'track.adform.net',
        pm: ${trackingSetupID},
        divider: encodeURIComponent('|'),
        pagename: encodeURIComponent('${pageName}')
        });
    (function () { var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = 'https://s2.adform.net/banners/scripts/st/trackpoint-async.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); })();
&#x3C;/script&#x3E;
&#x3C;noscript&#x3E;
    &#x3C;p style="margin:0;padding:0;border:0;">
        &#x3C;img src="https://track.adform.net/Serving/TrackPoint/?pm=${trackingSetupID}&ADFPageName=${encodeURIComponent(
                pageName
              )}&ADFdivider=|" width="1" height="1" alt="" />
    &#x3C;/p&#x3E;
&#x3C;/noscript&#x3E;
&#x3C;!-- Adform Tracking Code END --&#x3E;`;
              pre.appendChild(code);
              scriptsDiv.appendChild(pre);
              scriptsDiv.appendChild(varsDiv);
              scriptNodeList.push(scriptsDiv);
            });
            scriptsContainer.innerHTML = "";
            scriptNodeList.forEach((node) =>
              scriptsContainer.appendChild(node)
            );
            scriptsContainer.hidden = false;
          }
        }

        generateCodesButton.addEventListener("click", () => {
          let selectedPageNames = [];
          IDarray.forEach((ID) => {
            const pageName = document.getElementById(ID);
            if (pageName.checked && pageName.value.length > 0)
              selectedPageNames.push(pageName.value);
          });
          GenerateScripts(selectedPageNames, trackingSetupIdField.value);
        });
      }

      const casinoType = document.getElementById("casino");
      const casinoOptions = [
        "Homepage",
        "Registration",
        "First Time Deposit",
        "Deposit",
        "Game page",
      ];

      casinoType.addEventListener("click", () => {
        pageNamesContainer.hidden = !pageNamesContainer.hidden;

        if (pageNamesContainer.hidden) {
          scriptsContainer.hidden = true;
          errorMessageElement.hidden = true;
        }
        if (window.casinoPages === undefined) {
          window.casinoPages = "added";
          createPagesCheckboxList(casinoOptions);
        }
      });
    </script>
  </body>
</html>
